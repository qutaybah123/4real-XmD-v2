const { isSudo } = require('../lib/index');
const settings = require("../settings");

async function hackCommand(sock, chatId, message) {
    try {
        // Check if user is owner/sudo
        const senderId = message.key.participant || message.key.remoteJid;
        const senderIsSudo = await isSudo(senderId);
        const isOwner = message.key.fromMe || senderIsSudo;

        if (!isOwner) {
            return await sock.sendMessage(chatId, {
                text: "ğŸš« *Owner/Sudo only command!*"
            }, { quoted: message });
        }

        // Show processing indicator
        await sock.sendMessage(chatId, {
            react: { text: 'ğŸ’»', key: message.key }
        });

        try {
            const steps = [
                'ğŸ’» *HACK STARTING...* ğŸ’»',
                
                '*Initializing hacking tools...* ğŸ› ï¸',
                '*Connecting to remote servers...* ğŸŒ',
                
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 10%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 20%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 30%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 40%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 50%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 60%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 70%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 80%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 90%``` â³',
                '```[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%``` âœ…',
                
                'ğŸ”’ *System Breach: Successful!* ğŸ”“',
                'ğŸš€ *Command Execution: Complete!* ğŸ¯',
                
                '*ğŸ“¡ Transmitting data...* ğŸ“¤',
                '_ğŸ•µï¸â€â™‚ï¸ Ensuring stealth..._ ğŸ¤«',
                '*ğŸ”§ Finalizing operations...* ğŸ',
                
                'âš ï¸ *Note:* All actions are for demonstration purposes only.',
                'âš ï¸ *Reminder:* Ethical hacking is the only way to ensure security.',
                
                '> *á´˜á´á´¡á´‡Ê€á´‡á´… Ê™Ê ÊŸÉªÉ¢á´€É´É¢ á´›á´‡á´„Êœs* â˜£'
            ];

            // Send initial message
            await sock.sendMessage(chatId, {
                text: 'ğŸš€ *HACKING SIMULATION INITIATED*\n\nStarting hacking sequence...'
            }, { quoted: message });

            // Send each step with delay
            for (const line of steps) {
                await sock.sendMessage(chatId, { text: line });
                await new Promise(resolve => setTimeout(resolve, 800)); // 0.8 second delay
            }

            // Send completion message
            await sock.sendMessage(chatId, {
                text: 'âœ… *HACKING SIMULATION COMPLETED*\n\nThis was just a fun simulation! ğŸ®'
            });

        } catch (error) {
            console.error("Hack Command Error:", error);
            await sock.sendMessage(chatId, {
                text: "âŒ *Hacking simulation failed!* ğŸ”´\n\nSystem security protocols activated. ğŸ›¡ï¸"
            }, { quoted: message });
        }

    } catch (error) {
        console.error('Hack Command Main Error:', error);
        await sock.sendMessage(chatId, {
            text: "âŒ An error occurred during hacking simulation."
        }, { quoted: message });
    }
}

module.exports = hackCommand;
